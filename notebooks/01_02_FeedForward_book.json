{"paragraphs":[{"text":"%md\n順伝播型ニューラルネットワーク予測計算の 再現","user":"admin","dateUpdated":"2019-03-09T09:06:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549264784828_376552531","id":"20190204-071944_380755170","dateCreated":"2019-02-04T07:19:44+0000","dateStarted":"2019-03-09T09:06:15+0000","dateFinished":"2019-03-09T09:06:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2634"},{"text":"%md\n\nこのノートブックでは、シンプルなニューラルネットワークの内部で行われている計算について確認します","user":"admin","dateUpdated":"2019-03-13T05:49:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>このノートブックでは、シンプルなニューラルネットワークの内部で行われている計算について確認します</p>\n"}]},"apps":[],"jobName":"paragraph_1552456097570_-1679593569","id":"20190313-054817_1475899752","dateCreated":"2019-03-13T05:48:17+0000","dateStarted":"2019-03-13T05:49:03+0000","dateFinished":"2019-03-13T05:49:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2635"},{"title":"ライブラリの読み込み","text":"import numpy as np\r\nimport numpy.testing as npt\r\n\r\nfrom keras.models import Sequential\r\nfrom keras.layers import Dense\r\nfrom keras.activations import relu\r\nfrom keras.activations import sigmoid\r\nfrom keras import losses","user":"admin","dateUpdated":"2019-03-13T05:26:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true,"lineNumbers":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1549264827739_1415636717","id":"20190204-072027_307212161","dateCreated":"2019-02-04T07:20:27+0000","dateStarted":"2019-03-13T05:25:58+0000","dateFinished":"2019-03-13T05:25:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2636"},{"title":"隠れ層二層のシンプルなニューラルネットワークを構築","text":"model = Sequential()\r\nmodel.add(Dense(units=4, activation=relu, input_dim=2))\r\nmodel.add(Dense(units=4, activation=relu))\r\nmodel.add(Dense(units=1, activation=sigmoid))\r\nmodel.compile(loss=losses.binary_crossentropy, optimizer=\"SGD\", metrics=['accuracy'])\r\n# モデルは学習されていません。出力はランダムになります。","user":"admin","dateUpdated":"2019-03-13T05:26:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true,"lineNumbers":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1549264834442_1641884394","id":"20190204-072034_1235225714","dateCreated":"2019-02-04T07:20:34+0000","dateStarted":"2019-03-13T05:26:01+0000","dateFinished":"2019-03-13T05:26:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2637"},{"title":"各層ごとの重みとバイアスの次元の確認","text":"weights = model.get_weights()\n\nprint(weights[0].shape)  # input-1st, weight\nprint(weights[1].shape)  # input-1st, bias\nprint(\"-----------------\")\nprint(weights[2].shape)  # 1st-2nd, weight\nprint(weights[3].shape)  # 1st-2nd, bias\nprint(\"-----------------\")\nprint(weights[4].shape)  # 2nd-output, weight\nprint(weights[5].shape)  # 2nd-output, bias","user":"admin","dateUpdated":"2019-03-13T05:30:00+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","lineNumbers":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(2, 4)\n(4,)\n-----------------\n(4, 4)\n(4,)\n-----------------\n(4, 1)\n(1,)\n"}]},"apps":[],"jobName":"paragraph_1549264854402_1409126634","id":"20190204-072054_1195603714","dateCreated":"2019-02-04T07:20:54+0000","dateStarted":"2019-03-13T05:29:40+0000","dateFinished":"2019-03-13T05:29:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2638"},{"title":"ランダムな入力データを作成","text":"NUM_SAMPLES = 1  # 自主的な練習問題: 複数のサンプルでも機能することを確認\nx_in = np.random.random((NUM_SAMPLES, 2))\nprint(x_in)","user":"admin","dateUpdated":"2019-03-13T05:39:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true,"lineNumbers":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[0.93596285 0.12398255]]\n"}]},"apps":[],"jobName":"paragraph_1549265110946_1055525426","id":"20190204-072510_1887603766","dateCreated":"2019-02-04T07:25:10+0000","dateStarted":"2019-03-13T05:39:11+0000","dateFinished":"2019-03-13T05:39:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2639"},{"text":"# モデル全体\r\noutput = model.predict(x_in)\r\nprint(output)","user":"admin","dateUpdated":"2019-03-13T05:40:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"lineNumbers":true,"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[0.50333035]]\n"}]},"apps":[],"jobName":"paragraph_1552455581874_-1353631341","id":"20190313-053941_40101491","dateCreated":"2019-03-13T05:39:41+0000","dateStarted":"2019-03-13T05:39:48+0000","dateFinished":"2019-03-13T05:39:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2640"},{"text":"# 中間層の出力を得る\r\n# モデルの部分コピーを作成して出力を取得する。\r\n\r\n# 隠れ層 1\r\nmodel2 = Sequential()\r\nmodel2.add(Dense(units=4, activation=relu, input_dim=2, weights=model.layers[0].get_weights()))\r\nactivations_layer1 = model2.predict(x_in)\r\nprint(activations_layer1)\r\n\r\n# 隠れ層 2\r\nmodel3 = Sequential()\r\nmodel3.add(Dense(units=4, activation=relu, input_dim=2, weights=model.layers[0].get_weights()))\r\nmodel3.add(Dense(units=4, activation=relu, weights=model.layers[1].get_weights()))\r\nactivations_layer2 = model3.predict(x_in)\r\nprint(activations_layer2)\r\n","user":"admin","dateUpdated":"2019-03-13T05:43:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[ 0.09655433  0.30263436 -0.          0.49643466]]\n[[ 0.3825046  -0.          0.11884638  0.16057968]]\n"}]},"apps":[],"jobName":"paragraph_1549273687413_826240723","id":"20190204-094807_956238561","dateCreated":"2019-02-04T09:48:07+0000","dateStarted":"2019-03-13T05:43:47+0000","dateFinished":"2019-03-13T05:43:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2641"},{"text":"def relu_numpy(x):\n    # relu 活性化機能\n    return x * (x > 0)\n    \ndef sigmoid_numpy(x):\n    # シグモイド 活性化機能\n    return 1 / (1 + np.exp(-x))\n\ndef activation_numpy(w, b, x, activation):\n    # 層の出力計算\n    # w 重みパラメータ\n    # b バイアス\n    # x 蒼入力ベクトル\n    # activation 活性化機能\n    #\n    y_1 = (np.matmul(x, w) + b)\n    return activation(y_1)","user":"admin","dateUpdated":"2019-03-13T05:44:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1549277615872_669919575","id":"20190204-105335_1369329625","dateCreated":"2019-02-04T10:53:35+0000","dateStarted":"2019-03-13T05:43:59+0000","dateFinished":"2019-03-13T05:43:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2642"},{"text":"# 隠れ層1　計算の再現\nactivations_layer1_numpy = activation_numpy(weights[0], weights[1], x_in, relu_numpy)\nprint(activations_layer1_numpy)\nnpt.assert_almost_equal(activations_layer1_numpy, activations_layer1)","user":"admin","dateUpdated":"2019-03-13T05:44:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[ 0.09655433  0.30263438 -0.          0.49643463]]\n"}]},"apps":[],"jobName":"paragraph_1549328029584_-1517891990","id":"20190205-005349_405824874","dateCreated":"2019-02-05T00:53:49+0000","dateStarted":"2019-03-13T05:44:38+0000","dateFinished":"2019-03-13T05:44:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2643"},{"text":"# 隠れ層2　計算の再現\n# 入力は前の層（隠れ層1）の出力\nactivations_layer2_numpy = activation_numpy(weights[2], weights[3], activations_layer1_numpy, relu_numpy)\nprint(activations_layer2_numpy)\nnpt.assert_almost_equal(activations_layer2_numpy, activations_layer2)","user":"admin","dateUpdated":"2019-03-13T05:45:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[ 0.3825046  -0.          0.1188464   0.16057967]]\n"}]},"apps":[],"jobName":"paragraph_1549284370051_-1821059249","id":"20190204-124610_846454927","dateCreated":"2019-02-04T12:46:10+0000","dateStarted":"2019-03-13T05:45:44+0000","dateFinished":"2019-03-13T05:45:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2644"},{"text":"# モデル全体\noutput_numpy = activation_numpy(weights[4], weights[5], activations_layer2_numpy, sigmoid_numpy)\nprint(output_numpy)\nnpt.assert_almost_equal(output_numpy, output)","user":"admin","dateUpdated":"2019-03-13T05:46:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[0.50333034]]\n"}]},"apps":[],"jobName":"paragraph_1549284773300_1074523223","id":"20190204-125253_1404643474","dateCreated":"2019-02-04T12:52:53+0000","dateStarted":"2019-03-13T05:46:04+0000","dateFinished":"2019-03-13T05:46:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2645"},{"user":"admin","dateUpdated":"2019-02-09T12:29:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549277937443_1967553377","id":"20190204-105857_212029912","dateCreated":"2019-02-04T10:58:57+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2646"}],"name":"1_FeedForward_book","id":"2E43YTRBS","angularObjects":{"2E3P5UJ76:existing_process":[],"2E5XSMVWF:existing_process":[],"2E4FPTU8T:existing_process":[],"2E4NCXGG2:existing_process":[],"2E6CG6DEY:existing_process":[],"2E5FV5XZY:existing_process":[],"2E3G5X65Q:existing_process":[],"2E42HKRT6:existing_process":[],"2E5Q8XYMJ:existing_process":[],"2E5J3FU8H:existing_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}